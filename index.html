<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>–í—Å—ñ —Ö–≤–∏–ª—ñ –¥–æ–±—Ä–∞ ‚Äî –•–≤–∏–ª—ñ –î–æ–±—Ä–∞</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
         :root {
            --blue-light: #e0f2ff;
            --blue: #2196f3;
            --blue-dark: #1565c0;
            --red: #f44336;
        }
        
        body,
        html {
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--blue-light);
            color: #333;
            min-height: 100vh;
        }
        
        h1 {
            color: var(--blue-dark);
            margin: 1em 0 0.5em 0;
        }
        
        #citySearch {
            max-width: 400px;
            width: 90%;
            padding: 10px;
            margin-bottom: 1em;
            border-radius: 8px;
            border: 1px solid #ccc;
            font-size: 16px;
        }
        
        #map {
            width: 90vw;
            max-width: 1000px;
            height: 70vh;
            border-radius: 12px;
            box-shadow: 0 0 12px rgba(0, 0, 0, 0.15);
        }
        
        .popup-content {
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 280px;
        }
        
        .popup-photo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
            border: 1px solid #ccc;
        }
        
        .popup-info {
            flex: 1;
            font-size: 14px;
        }
        
        .popup-info h3 {
            margin: 0 0 5px 0;
            font-size: 16px;
            color: var(--blue-dark);
        }
        
        .wave-count {
            background: var(--blue);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            display: inline-block;
            margin-top: 4px;
        }
        
        .reviews {
            margin-top: 6px;
            font-size: 12px;
            color: var(--red);
        }
        /* header –∑–∞–π–º–∞—Ç–∏–º–µ –≤—Å—é —à–∏—Ä–∏–Ω—É */
        
        .main-header {
            width: 100%;
            background: var(--blue);
            color: white;
            padding: 10px 20px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            position: fixed;
            /* —â–æ–± –∑–∞–≤–∂–¥–∏ –∑–≤–µ—Ä—Ö—É */
            top: 0;
            left: 0;
            z-index: 1000;
        }
        
        .header-container {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        /* —â–æ–± –∫–æ–Ω—Ç–µ–Ω—Ç –ø—ñ–¥ header –Ω–µ –ø–µ—Ä–µ–∫—Ä–∏–≤–∞–≤—Å—è */
        
        main {
            max-width: 1000px;
            margin: 80px auto 2em auto;
            /* –∑–≤–µ—Ä—Ö—É –≤—ñ–¥—Å—Ç—É–ø –ø—ñ–¥ header */
            padding: 1em;
            background: var(--blue-light);
            width: 90vw;
        }
        
        .logo {
            font-size: 20px;
            font-weight: bold;
        }
        
        .header-nav {
            display: flex;
            gap: 10px;
        }
        
        .header-btn {
            background: white;
            color: var(--blue-dark);
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: bold;
            cursor: pointer;
            transition: background 0.2s;
            text-decoration: none;
        }
        
        .header-btn:hover {
            background: var(--blue-light);
        }
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω—ñ—Å—Ç—å –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω—ñ–≤ */
        
        @media (max-width: 600px) {
            body,
            html {
                font-size: 14px;
            }
            .main-header {
                padding: 8px 12px;
            }
            .header-container {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
            .header-nav {
                flex-direction: column;
                width: 100%;
                gap: 6px;
            }
            .header-btn {
                width: 100%;
                padding: 10px;
                text-align: center;
                font-size: 14px;
            }
            h1 {
                font-size: 1.4rem;
                margin-top: 0.8em;
            }
            #citySearch {
                max-width: 100%;
                width: 100%;
                font-size: 14px;
                padding: 8px;
            }
            #map {
                width: 100vw;
                height: 60vh;
                border-radius: 0;
                box-shadow: none;
            }
            main {
                max-width: 1000px;
                margin: 80px auto 2em auto;
                /* –≤–∂–µ –¥–æ–±—Ä–µ, –∑–∞–ª–∏—à–∞—î–º–æ */
                padding: 1em;
                background: var(--blue-light);
                width: 90vw;
                display: flex;
                flex-direction: column;
                align-items: center;
                /* –¥–æ–¥–∞—î–º–æ —Ü–µ */
                text-align: center;
                /* –¥–æ–¥–∞—î–º–æ —Ü–µ */
            }
            .popup-content {
                max-width: 200px;
                gap: 6px;
            }
            .popup-photo {
                width: 40px;
                height: 40px;
            }
            .popup-info h3 {
                font-size: 14px;
            }
            .wave-count {
                font-size: 11px;
                padding: 1px 6px;
            }
            .reviews {
                font-size: 11px;
            }
        }
    </style>
</head>

<body>
    <header class="main-header">
        <div class="header-container">
            <div class="logo">üåä –•–≤–∏–ª—ñ –î–æ–±—Ä–∞</div>
            <nav class="header-nav">
                <a class="header-btn" href="profile.html">–ø—Ä–æ—Ñ—ñ–ª—å</a>
                <a class="header-btn" href="admin.html">–ê–¥–º—ñ–Ω</a>
            </nav>
        </div>
    </header>
    <main>
        <h1>–í—Å—ñ —Ö–≤–∏–ª—ñ –¥–æ–±—Ä–∞ –Ω–∞ –∫–∞—Ä—Ç—ñ</h1>
        <input type="text" id="citySearch" placeholder="–ü–æ—à—É–∫ –ø–æ –º—ñ—Å—Ç—É..." />

        <div id="map"></div>
    </main>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤
        const userData = {
            "2106431200": {
                "name": "—Ä–æ–º–∞–Ω",
                "format": "online",
                "specialty": "—è –±—É—Ö–≥–∞–ª—Ç–µ—Ä",
                "help_description": "–Ø –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ –º–æ–∂—É –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –≤–∞–º –≤–∞—à—ñ –≥—Ä–æ—â—ñ",
                "referal": "https://t.me/Wave_of_Kindness_bot?start=referal_2106431200",
                "came_from": "2106431200",
                "wave_proof": "https://t.me/Wave_of_Kindness_bot?start=referal_2106431200",
                "city": "–ö–∏—ó–≤",
                "coords": [50.45, 30.52],
                "photo": "https://randomuser.me/api/portraits/men/32.jpg"
            },
            "7148034659": {
                "came_from": "2106431200",
                "wave_proof": "https://t.me/Wave_of_Kindness_bot?start=referal_2106431200",
                "name": "–¥–º–∏—Ç—Ä–æ",
                "specialty": "—è —Å–∞–Ω—Ç–µ—Ö–Ω—ñ–∫",
                "help_description": "–Ø –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–æ –º–æ–∂—É –≤—ñ–¥—Ä–µ–º–æ–Ω—Ç—É–≤–∞—Ç–∏ –∫—Ä–∞–Ω",
                "referal": "https://t.me/Wave_of_Kindness_bot?start=referal_7148034659",
                "user_wave_link": "https://t.me/Wave_of_Kindness_bot?start=referal_2106431200",
                "city": "–õ—å–≤—ñ–≤",
                "coords": [49.84, 24.03],
                "photo": "https://randomuser.me/api/portraits/men/85.jpg"
            }
        };

        // –ö–æ–Ω–≤–µ—Ä—Ç—É—î–º–æ –æ–±'—î–∫—Ç userData –≤ –º–∞—Å–∏–≤ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –∫–∞—Ä—Ç–æ—é
        const wavesData = Object.keys(userData).map(userId => {
            return {
                id: userId,
                ...userData[userId]
            };
        });

        const map = L.map('map').setView([48.38, 31.17], 6); // –¶–µ–Ω—Ç—Ä –£–∫—Ä–∞—ó–Ω–∏ –¥–ª—è –ø—Ä–∏–∫–ª–∞–¥—É

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '¬© OpenStreetMap'
        }).addTo(map);

        let markers = [];

        // –§—É–Ω–∫—Ü—ñ—è —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–ø–∞–ø–∞ –¥–ª—è –º–∞—Ä–∫–µ—Ä–∞
        function createPopupContent(user) {
            return `
        <div class="popup-content">
          <img class="popup-photo" src="${user.photo}" alt="–§–æ—Ç–æ ${user.name}" />
          <div class="popup-info">
            <h3>${user.name}</h3>
            <div><strong>–ú—ñ—Å—Ç–æ:</strong> ${user.city}</div>
            <div class="specialty">${user.specialty}</div>
            <div class="help-description">${user.help_description}</div>
            <div class="referral-link">
                <strong>–ü–æ—Å–∏–ª–∞–Ω–Ω—è:</strong> <a href="${user.referal}" target="_blank">${user.referal.substring(0, 20)}...</a>
            </div>
          </div>
        </div>
      `;
        }

        // –î–æ–¥–∞–≤–∞–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤ –Ω–∞ –∫–∞—Ä—Ç—É
        function addMarkers(filteredData) {
            markers.forEach(m => map.removeLayer(m));
            markers = [];

            filteredData.forEach(user => {
                const marker = L.marker(user.coords).addTo(map);
                marker.bindPopup(createPopupContent(user));
                markers.push(marker);
            });
        }

        // –ü–æ—á–∞—Ç–∫–æ–≤–µ –¥–æ–¥–∞–≤–∞–Ω–Ω—è –º–∞—Ä–∫–µ—Ä—ñ–≤
        addMarkers(wavesData);

        // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –∑–∞ –º—ñ—Å—Ç–æ–º
        const citySearch = document.getElementById('citySearch');
        citySearch.addEventListener('input', () => {
            const query = citySearch.value.trim().toLowerCase();
            if (!query) {
                addMarkers(wavesData);
                map.setView([48.38, 31.17], 6);
                return;
            }

            const filtered = wavesData.filter(user =>
                user.city && user.city.toLowerCase().includes(query)
            );
            addMarkers(filtered);

            if (filtered.length > 0) {
                // –¶–µ–Ω—Ç—Ä—É—î–º–æ –∫–∞—Ä—Ç—É –ø–æ –ø–µ—Ä—à–æ–º—É –∑–Ω–∞–π–¥–µ–Ω–æ–º—É
                map.setView(filtered[0].coords, 10);
            }
        });
    </script>
</body>

</html>
